<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2019-10-18">

<title>Ryan Safner - If You’re Going to Learn R, Learn the Tidyverse</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../me2023.jpg" rel="icon" type="image/jpeg">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script type="text/javascript">

(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-12760297-1', 'auto');

ga('send', {
  hitType: 'pageview',
  'anonymizeIp': true,
});
</script>
<style>html{ scroll-behavior: smooth; }</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">


<link rel="stylesheet" href="../styles.css">
<meta property="og:title" content="Ryan Safner - If You’re Going to Learn R, Learn the Tidyverse">
<meta property="og:description" content="">
<meta property="og:image" content="https://ryansafner.com/posts/me2023.jpg">
<meta property="og:site-name" content="Ryan Safner">
<meta name="twitter:title" content="Ryan Safner - If You’re Going to Learn R, Learn the Tidyverse">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://ryansafner.com/posts/me2023.jpg">
<meta name="twitter:creator" content="@ryansafner">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Ryan Safner</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../CV.pdf" rel="" target="">
 <span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../teaching.html" rel="" target="">
 <span class="menu-text">Teaching</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../research.html" rel="" target="">
 <span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../software.html" rel="" target="">
 <span class="menu-text">Software</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../blog.html" rel="" target="">
 <span class="menu-text">Blog</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#tidyverse-and-opinionated-r" id="toc-tidyverse-and-opinionated-r" class="nav-link active" data-scroll-target="#tidyverse-and-opinionated-r"><code>tidyverse</code> and Opinionated R</a></li>
  <li><a href="#class-1-is-base-r-necessary" id="toc-class-1-is-base-r-necessary" class="nav-link" data-scroll-target="#class-1-is-base-r-necessary">Class 1: Is Base R Necessary?</a></li>
  <li><a href="#class-2-data-visualization-with-ggplot2" id="toc-class-2-data-visualization-with-ggplot2" class="nav-link" data-scroll-target="#class-2-data-visualization-with-ggplot2">Class 2: Data Visualization with <code>ggplot2</code></a></li>
  <li><a href="#class-3-data-wrangling-with-tidyverse-mostly-dplyr" id="toc-class-3-data-wrangling-with-tidyverse-mostly-dplyr" class="nav-link" data-scroll-target="#class-3-data-wrangling-with-tidyverse-mostly-dplyr">Class 3: Data Wrangling with <code>tidyverse</code> (mostly <code>dplyr</code>)</a></li>
  <li><a href="#class-4-optimizing-workflow-r-projects-and-markdown" id="toc-class-4-optimizing-workflow-r-projects-and-markdown" class="nav-link" data-scroll-target="#class-4-optimizing-workflow-r-projects-and-markdown">Class 4: Optimizing Workflow: R Projects and Markdown</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">If You’re Going to Learn R, Learn the Tidyverse</h1>
  <div class="quarto-categories">
    <div class="quarto-category">rstats</div>
    <div class="quarto-category">markdown</div>
    <div class="quarto-category">github</div>
    <div class="quarto-category">teaching</div>
    <div class="quarto-category">econometrics</div>
  </div>
  </div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 18, 2019</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<p>This is an opinionated post based on how I teach <a href="http://metricsf19.classes.ryansafner.com">my undergraduate econometrics course</a>. It will not be for everybody. The title applies mostly to anyone who wants to do <a href="https://ryansafner.com/post/econometrics-data-science-and-causal-inference/">data science or econometrics</a> with R. This is the second time I have taught this course with R, and I have changed it around in many ways that I think optimize the process for students. In this post, I’ll cover just two major changes:</p>
<ol type="1">
<li>Learn R before the econometric/statistical theory</li>
<li>Learn <em>tidyverse</em> R, specifically</li>
</ol>
<p>The <a href="http://ryansafner.com/courses/econ480">last time I taught this course</a> (and my first exploration with R), I did neither. Part of this was because I had just learned base R a few months before the course began, and was still learning and discovering new commands as the semester went on. I waited several weeks to introduce R, starting instead with econometric theory and review, and then interspersing bits of R as it became relevant for each task (running regressions, making plots, changing variables, and various different models). While it was fine for most students, there are some changes that will make students’ lives easier.</p>
<p>I am still partway through the course, so it remains to be seen if students R skills are more developed by the end of the course (as they wrap up their projects) because they learned a lot of R <em>first</em>, versus in bite-sized chunks spread out over the semester.</p>
<section id="tidyverse-and-opinionated-r" class="level2">
<h2 class="anchored" data-anchor-id="tidyverse-and-opinionated-r"><code>tidyverse</code> and Opinionated R</h2>
<blockquote class="blockquote">
<p>The tidyverse is an opinionated <a href="https://www.tidyverse.org/packages">collection of R packages</a> designed for data science. All packages share an underlying design philosophy, grammar, and data structures. - <a href="https://www.tidyverse.org/">tidyverse.org</a></p>
</blockquote>
<p>One of the common refrains about what is awesome/terrible about R is that there are multiple ways to accomplish the same task. Here is where the opinions begin, so I’ll give mine: Code written with tidyverse packages simply looks a lot better and is far easier for <em>humans</em> to read, particularly if you follow the <a href="https://style.tidyverse.org/">style guidelines</a>, as I do.</p>
<p>For example, the following code takes data from the excellent <a href="https://github.com/jennybc/gapminder">gapminder</a> dataset and package, and subsets the data to:</p>
<ol type="1">
<li>look only at U.S. observations</li>
<li>keep only the <code>year</code>, <code>gdpPercap</code> and <code>pop</code> variables</li>
<li>create a new variable called <code>GDP</code> by multiplying <code>gdpPercap</code> and <code>pop</code></li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>gapminder1<span class="ot">&lt;-</span>gapminder[gapminder<span class="sc">$</span>country<span class="sc">==</span><span class="st">"United States"</span>, <span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"gdpPercap"</span>, <span class="st">"pop"</span>)]</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>gapminder1<span class="sc">$</span>gdp<span class="ot">&lt;-</span>gapminder1<span class="sc">$</span>gdpPercap<span class="sc">*</span>gapminder1<span class="sc">$</span>pop</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>This is doable in base R, and often requires saving the output as a new object for later use.</p>
<p>Below, the same procedure is done with <code>dplyr</code> and using the pipe <code>%&gt;%</code> from <code>magrittr</code> (both part of the <code>tidyverse</code>).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>gapminder <span class="sc">%&gt;%</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(country <span class="sc">==</span> <span class="st">"United States"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(year, gdpPercap, pop) <span class="sc">%&gt;%</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GDP=</span>gdpPercap <span class="sc">*</span> pop)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
    year gdpPercap       pop     GDP
   &lt;int&gt;     &lt;dbl&gt;     &lt;int&gt;   &lt;dbl&gt;
 1  1952    13990. 157553000 2.20e12
 2  1957    14847. 171984000 2.55e12
 3  1962    16173. 186538000 3.02e12
 4  1967    19530. 198712000 3.88e12
 5  1972    21806. 209896000 4.58e12
 6  1977    24073. 220239000 5.30e12
 7  1982    25010. 232187835 5.81e12
 8  1987    29884. 242803533 7.26e12
 9  1992    32004. 256894189 8.22e12
10  1997    35767. 272911760 9.76e12
11  2002    39097. 287675526 1.12e13
12  2007    42952. 301139947 1.29e13</code></pre>
</div>
</div>
<p>The beauty of <code>tidyverse</code> (particularly <code>dplyr</code>, which will be used the most for data wrangling) comes from a few features:</p>
<ol type="1">
<li>It uses active, common sense, natural language verbs to accomplish most of its tasks. <code>filter</code>, <code>select</code>, and <code>mutate</code> (among others) are easy to understand what is happening at each stage.</li>
<li>It allows use of the pipe <code>%&gt;%</code> to chain commands into a single sequence (and better yet, every time I use a pipe, I start a new line to make code far more readable).</li>
<li>It <em>shows</em> you the output by default and does not store (or overwrite) it anywhere until or unless you assign it to an object. This allows you to preview what your code does before you need to worry about saving it.</li>
</ol>
<p>Note that this can be done without use of the pipe, and by storing objects, as such:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>gapminder_US<span class="ot">&lt;-</span><span class="fu">filter</span>(gapminder, country <span class="sc">==</span> <span class="st">"United States"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>gapminder_US<span class="ot">&lt;-</span><span class="fu">select</span>(gapminder_US, year, gdpPercap, pop)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>gapminder_US<span class="ot">&lt;-</span><span class="fu">mutate</span>(gapminder_US, <span class="at">GDP=</span>gdpPercap <span class="sc">*</span> pop)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>gapminder_US</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 12 × 4
    year gdpPercap       pop     GDP
   &lt;int&gt;     &lt;dbl&gt;     &lt;int&gt;   &lt;dbl&gt;
 1  1952    13990. 157553000 2.20e12
 2  1957    14847. 171984000 2.55e12
 3  1962    16173. 186538000 3.02e12
 4  1967    19530. 198712000 3.88e12
 5  1972    21806. 209896000 4.58e12
 6  1977    24073. 220239000 5.30e12
 7  1982    25010. 232187835 5.81e12
 8  1987    29884. 242803533 7.26e12
 9  1992    32004. 256894189 8.22e12
10  1997    35767. 272911760 9.76e12
11  2002    39097. 287675526 1.12e13
12  2007    42952. 301139947 1.29e13</code></pre>
</div>
</div>
<p><a href="http://varianceexplained.org/r/teach-tidyverse/">I am not alone in this view.</a> As far as it relates to teaching, the implications are clear: The overwhelming majority of students are new to “programming”, so they will be frustrated <em>regardless</em> of what order the content was taught, or in what flavor of language. They do not need to know the “base R” way of doing something just so that they can see that the tidyverse may be better or more efficient - they just need to learn <em>one</em> way to accomplish their task, it might as well be (what I think is) the “better” one.</p>
<p>So, I began the course (after two days of overview, why this course is important, useful, etc.) with 4 intensive classes of learning R, and tidyverse specifically. First, a day about base R, second, a day about ggplot2 for data visualization, third, a day of data wrangling with tidyverse, and finally a day about workflow and other tools (mainly r markdown). I cover the basics behind each of them, and what I have learned, below:</p>
</section>
<section id="class-1-is-base-r-necessary" class="level2">
<h2 class="anchored" data-anchor-id="class-1-is-base-r-necessary">Class 1: Is Base R Necessary?</h2>
<p>It somehow seems more “pure” to teach R from the ground up: First we discuss basic R commands, then we build more complicated functions in, then we show how to manipulate data, then we show how to plot, and later: “oh by the way there are these packages that do all of this more elegantly and in half as many lines of code.” That is how I taught econometrics last year.</p>
<p>We need to remember this is a class in econometrics and data analysis that <em>uses</em> R, not a class in computer science or the R language. In fact, people with a computer science/programming background seem to find R <a href="https://www.youtube.com/watch?v=6S9r_YbqHy8&amp;feature=youtu.be">particularly annoying as a programming language</a>. It is highly domain-specific (that domain chiefly being statistics), and should be appreciated as such.</p>
<p>In any case, I still made a point this year to make <a href="https://metricsf19.classes.ryansafner.com/class/03-class/">my first R-based class</a> entirely about Base R without the bells and whistles.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Students and R-users need to understand some basic syntax of functions, as well as the object-oriented nature of the language. I made sure that they understand the following really well:</p>
<ol type="1">
<li>What are packages, how to find, install, and load them.</li>
<li>How to get help in R and on the internet for R functions.</li>
<li>Different types of objects: especially <code>vector</code> and <code>data.frame</code></li>
<li>Different data classes: especially <code>numeric</code> and <code>character</code>, and how to check them</li>
<li>Some basic functions for making vectors and for getting statistics (<code>c()</code>, <code>mean()</code>, <code>sd()</code>, etc.)</li>
<li>The basics of data frames: recognizing each column is a vector, how to summarize them, how to subset by row, column, and element</li>
</ol>
<p>I try not to go overboard (I omit things like <code>factor</code> and <code>logical</code> classes, <code>list</code> or <code>matrix</code> objects) and tell them not to worry too much about manipulating dataframes in Base R, as that is what <code>tidyverse</code> will accomplish much more intuitively and efficiently.</p>
</section>
<section id="class-2-data-visualization-with-ggplot2" class="level2">
<h2 class="anchored" data-anchor-id="class-2-data-visualization-with-ggplot2">Class 2: Data Visualization with <code>ggplot2</code></h2>
<p>The <a href="https://metricsf19.classes.ryansafner.com/class/04-class/">second R-class</a> I taught students all about data visualization with <code>ggplot2</code>. Not only do I think it is aesthetically superior to anything from Base R,<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> it also allows students to think about the important elements of a plot, and optimize each one accordingly, with the “grammar of graphics.” This is a pretty steep learning curve compared to typing <code>plot(y,x)</code> and seeing a scatterplot appear, but in the end, it is worth it.</p>
<p>In class, I build a few plots layer by layer:</p>
<ol type="1">
<li><code>data</code></li>
<li><code>aes</code>thetics</li>
<li><code>geom</code>etric objects</li>
<li><code>facets</code></li>
<li><code>labels</code></li>
<li><code>scale</code>s</li>
<li><code>theme</code></li>
</ol>
<p>At each layer, I explain what each layer does and many of the possibilities for each layer.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> mpg)<span class="sc">+</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> displ,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> hwy)<span class="sc">+</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> class))<span class="sc">+</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()<span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>year)<span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Engine Displacement (Liters)"</span>,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Highway MPG"</span>,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"Car Mileage and Displacement"</span>,</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">"More Displacement Lowers Highway MPG"</span>,</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">caption =</span> <span class="st">"Source: EPA"</span>,</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">"Vehicle Class"</span>)<span class="sc">+</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_viridis_d</span>()<span class="sc">+</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()<span class="sc">+</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">text =</span> <span class="fu">element_text</span>(<span class="at">family =</span> <span class="st">"Fira Sans"</span>),</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position=</span><span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="if-youre-going-to-learn-r-learn-the-tidyverse_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This is also the students’ first exposure to <code>tidyverse</code>, though it is not yet apparent. My one regret, in retrospect, is that plot layers are combined with <code>+</code> instead of <code>%&gt;%</code>.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> After learning other <code>tidyverse</code> packages such as <code>dplyr</code>, students would try to add plot layers with <code>%&gt;%</code> but I would continuously have to remind them that layers are combined with <code>+</code>.</p>
<p>Recall, all of this is done well before we cover basic statistics or econometric theory. When I was teaching students <em>how</em> to construct various plots with <code>ggplot2</code>, this was before they knew <em>why</em> they needed a scatterplot or a boxplot.</p>
</section>
<section id="class-3-data-wrangling-with-tidyverse-mostly-dplyr" class="level2">
<h2 class="anchored" data-anchor-id="class-3-data-wrangling-with-tidyverse-mostly-dplyr">Class 3: Data Wrangling with <code>tidyverse</code> (mostly <code>dplyr</code>)</h2>
<p>The <a href="https://metricsf19.classes.ryansafner.com/class/05-class/">third class</a> was all about <code>tidyverse</code> as a unifying set of packages with a common philosophy and grammar. I did discuss several core packages:</p>
<ol type="1">
<li><code>tibble</code> for friendlier dataframes<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></li>
<li><code>magrittr</code> for using the pipe <code>%&gt;%</code> to chain code together</li>
<li><code>readr</code> for importing data (mostly <code>.csv</code><a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></li>
<li><code>tidyr</code> for reshaping data</li>
</ol>
<p>But the primary focus was on <code>dplyr</code> and its verbs:</p>
<ol type="1">
<li><code>filter()</code> to keep selected observations</li>
<li><code>select()</code> to keep selected variables</li>
<li><code>arrange()</code> to reorder observations by a value</li>
<li><code>mutate()</code> to create new variables</li>
<li><code>summarize()</code> to create summary statistics</li>
<li><code>group_by()</code> for performing operations by group</li>
</ol>
<p>We worked with gapminder data to accomplish a wide variety of tasks using these commands.</p>
</section>
<section id="class-4-optimizing-workflow-r-projects-and-markdown" class="level2">
<h2 class="anchored" data-anchor-id="class-4-optimizing-workflow-r-projects-and-markdown">Class 4: Optimizing Workflow: R Projects and Markdown</h2>
<p>The <a href="https://metricsf19.classes.ryansafner.com/class/06-class/">fourth and final class</a> dedicated to R was all about optimizing workflow with a few tweaks. I have not used Microsoft Office products in about 10 years (more posts to come later), and in the last year, have migrated <strong>ALL</strong> of my document-preparation (that’s research papers, teaching materials, exams, slides, websites, <em>everything</em>) to markdown files I write inside of R Studio and track with version control on GitHub.</p>
<p>When I show to students that there are other options to Microsoft Word and Powerpoint, their jaws drop, particularly when I show all that you can do with a single plain-text document (integrating text, code, commands, plots, citations and bibliography etc) that exports to pdf, html, slides, and other output. Last semester, after I showed them <code>R Markdown</code>, several students told me it was the best thing about the class, and some still use it for other assignments in other classes on their own. This deserves its own series of posts, so for now I will focus on the two or three things I tried to teach students <em>in addition</em> to how to use Markdown.</p>
<p>First, <strong>R Projects</strong> are absolutely essential. I discovered these late in the game last year, but now realized that they solve far more problems than trying to do without them.</p>
<p>The #1 unnecessary problem I encounter with students is trying to load data from external sources. The world is not full of tidy pre-cleaned data, or even data that only come in <code>.csv</code> formats. <code>tidyr</code> is great for that, and so is <code>readr</code>, but the problem actually is one of basic file operations on a computer: students (and R) don’t know where the data is saved on their computers! Rather than trying to teach them how to write out relative or absolute file paths to locate files on their computer, R Projects solve this problem by setting the default working directory to the folder where the project is stored on their computer. That means that if you store the data file in that folder, you only need to load it (with <code>readr</code> or equivalent) with (e.g.) <code>read_csv("thedata.csv"</code>), no more worrying about file paths!</p>
<p>I also encourage students to create a logical folder hierarchy within their projects, similar to what I show in <a href="https://github.com/ryansafner/workflow">this repository</a>.</p>
<p>Second, <strong>version control</strong> with Github. I never actually got around to showing this in class, but a number of students expressed interest in learning how to do this. I feel it’s a bit advanced and requires a bit more computing expertise (but not too much, since I’m able to pull it off!), but I use it constantly. Perhaps more posts on this later.</p>
<p>In any case, after teaching these workflow methods, looking back on the first 3 R classes, I am tempted to just start from scratch with projects and markdown and make students use them from the beginning. Perhaps next year.</p>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Though I allude to more complex examples to give them a taste of what’s to come!<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>If it was not clear in my posts by now, I have high aesthetic standards.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>I believe this is due to the unique history of <code>ggplot2</code> coming before the <code>tidyverse</code> was a full idea. Though I hear in future versions, this may be fixed!<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>I simply replaced all dataframes in the course with tibbles<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>And derivative packages such as <code>readxl</code> and <code>haven</code> for importing other types of data such as <code>.xlsx</code> or Stata’s <code>.dat</code>.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



<script src="../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>