<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R For Econometrics: A Modest Handbook</title>
  <meta name="description" content="This is a simple guide intended for my ECON 480 - Econometrics students at Hood College.">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="R For Econometrics: A Modest Handbook" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a simple guide intended for my ECON 480 - Econometrics students at Hood College." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R For Econometrics: A Modest Handbook" />
  
  <meta name="twitter:description" content="This is a simple guide intended for my ECON 480 - Econometrics students at Hood College." />
  

<meta name="author" content="Ryan Safner (safner@hood.edu)">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="plotting.html">
<link rel="next" href="advanced-regression.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for Econometrics: A Modest Handbook</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#how-to-read-this-guide"><i class="fa fa-check"></i><b>1.1</b> How to Read this Guide</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="basics.html"><a href="basics.html"><i class="fa fa-check"></i><b>2</b> Basics</a><ul>
<li class="chapter" data-level="2.1" data-path="basics.html"><a href="basics.html#operating-r-studio"><i class="fa fa-check"></i><b>2.1</b> Operating R Studio</a><ul>
<li class="chapter" data-level="2.1.1" data-path="basics.html"><a href="basics.html#keyboard-shortcuts"><i class="fa fa-check"></i><b>2.1.1</b> Keyboard Shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="basics.html"><a href="basics.html#Working-directory"><i class="fa fa-check"></i><b>2.2</b> Working Directory (<code>wd</code>)</a></li>
<li class="chapter" data-level="2.3" data-path="basics.html"><a href="basics.html#packages"><i class="fa fa-check"></i><b>2.3</b> Packages</a></li>
<li class="chapter" data-level="2.4" data-path="basics.html"><a href="basics.html#useful-packages"><i class="fa fa-check"></i><b>2.4</b> Useful Packages</a></li>
<li class="chapter" data-level="2.5" data-path="basics.html"><a href="basics.html#calculations"><i class="fa fa-check"></i><b>2.5</b> Calculations</a></li>
<li class="chapter" data-level="2.6" data-path="basics.html"><a href="basics.html#hints-for-writing-code"><i class="fa fa-check"></i><b>2.6</b> Hints for Writing Code</a><ul>
<li class="chapter" data-level="2.6.1" data-path="basics.html"><a href="basics.html#naming-objects"><i class="fa fa-check"></i><b>2.6.1</b> Naming Objects</a></li>
<li class="chapter" data-level="2.6.2" data-path="basics.html"><a href="basics.html#commenting"><i class="fa fa-check"></i><b>2.6.2</b> Commenting</a></li>
<li class="chapter" data-level="2.6.3" data-path="basics.html"><a href="basics.html#managing-your-workflow"><i class="fa fa-check"></i><b>2.6.3</b> Managing Your Workflow</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="basics.html"><a href="basics.html#getting-help"><i class="fa fa-check"></i><b>2.7</b> Getting Help</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="objects.html"><a href="objects.html"><i class="fa fa-check"></i>Objects</a><ul>
<li class="chapter" data-level="2.8" data-path="objects.html"><a href="objects.html#vectors"><i class="fa fa-check"></i><b>2.8</b> Vectors</a><ul>
<li class="chapter" data-level="2.8.1" data-path="objects.html"><a href="objects.html#functions"><i class="fa fa-check"></i><b>2.8.1</b> Functions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="other-object-types.html"><a href="other-object-types.html"><i class="fa fa-check"></i><b>3</b> Other Object Types</a><ul>
<li class="chapter" data-level="3.1" data-path="other-object-types.html"><a href="other-object-types.html#lists"><i class="fa fa-check"></i><b>3.1</b> Lists</a></li>
<li class="chapter" data-level="3.2" data-path="other-object-types.html"><a href="other-object-types.html#matrix"><i class="fa fa-check"></i><b>3.2</b> Matrix</a></li>
<li class="chapter" data-level="3.3" data-path="other-object-types.html"><a href="other-object-types.html#data-frame"><i class="fa fa-check"></i><b>3.3</b> Data Frame</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-classes.html"><a href="data-classes.html"><i class="fa fa-check"></i><b>4</b> Data Classes</a><ul>
<li class="chapter" data-level="4.0.1" data-path="data-classes.html"><a href="data-classes.html#numeric"><i class="fa fa-check"></i><b>4.0.1</b> Numeric</a></li>
<li class="chapter" data-level="4.0.2" data-path="data-classes.html"><a href="data-classes.html#double"><i class="fa fa-check"></i><b>4.0.2</b> Double</a></li>
<li class="chapter" data-level="4.0.3" data-path="data-classes.html"><a href="data-classes.html#logical"><i class="fa fa-check"></i><b>4.0.3</b> Logical</a></li>
<li class="chapter" data-level="4.0.4" data-path="data-classes.html"><a href="data-classes.html#character"><i class="fa fa-check"></i><b>4.0.4</b> Character</a></li>
<li class="chapter" data-level="4.0.5" data-path="data-classes.html"><a href="data-classes.html#factor"><i class="fa fa-check"></i><b>4.0.5</b> Factor</a></li>
<li class="chapter" data-level="4.1" data-path="data-classes.html"><a href="data-classes.html#checking-or-reclassifying-objects"><i class="fa fa-check"></i><b>4.1</b> Checking or Reclassifying Objects</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-wrangling.html"><a href="data-wrangling.html"><i class="fa fa-check"></i>Data Wrangling</a><ul>
<li class="chapter" data-level="4.2" data-path="data-wrangling.html"><a href="data-wrangling.html#packages-1"><i class="fa fa-check"></i><b>4.2</b> Packages</a></li>
<li class="chapter" data-level="4.3" data-path="data-wrangling.html"><a href="data-wrangling.html#importing-data"><i class="fa fa-check"></i><b>4.3</b> Importing Data</a></li>
<li class="chapter" data-level="4.4" data-path="data-wrangling.html"><a href="data-wrangling.html#merging-data"><i class="fa fa-check"></i><b>4.4</b> Merging Data</a></li>
<li class="chapter" data-level="4.5" data-path="data-wrangling.html"><a href="data-wrangling.html#using-the-pipe-operator"><i class="fa fa-check"></i><b>4.5</b> Using the <code>%&gt;%</code> “Pipe” Operator</a></li>
<li class="chapter" data-level="4.6" data-path="data-wrangling.html"><a href="data-wrangling.html#subsetting"><i class="fa fa-check"></i><b>4.6</b> Subsetting</a></li>
<li class="chapter" data-level="4.7" data-path="data-wrangling.html"><a href="data-wrangling.html#section"><i class="fa fa-check"></i><b>4.7</b> </a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>5</b> Plotting</a><ul>
<li class="chapter" data-level="5.1" data-path="plotting.html"><a href="plotting.html#plotting-in-base-r"><i class="fa fa-check"></i><b>5.1</b> Plotting in Base <code>R</code></a><ul>
<li class="chapter" data-level="5.1.1" data-path="plotting.html"><a href="plotting.html#histogram"><i class="fa fa-check"></i><b>5.1.1</b> Histogram</a></li>
<li class="chapter" data-level="5.1.2" data-path="plotting.html"><a href="plotting.html#boxplot"><i class="fa fa-check"></i><b>5.1.2</b> Boxplot</a></li>
<li class="chapter" data-level="5.1.3" data-path="plotting.html"><a href="plotting.html#scatterplot"><i class="fa fa-check"></i><b>5.1.3</b> Scatterplot</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="plotting.html"><a href="plotting.html#with-ggplot2"><i class="fa fa-check"></i><b>5.2</b> With <code>ggplot2</code></a><ul>
<li class="chapter" data-level="5.2.1" data-path="plotting.html"><a href="plotting.html#two-ways-to-plot"><i class="fa fa-check"></i><b>5.2.1</b> Two Ways to Plot</a></li>
<li class="chapter" data-level="5.2.2" data-path="plotting.html"><a href="plotting.html#two-ways-to-plot-ii"><i class="fa fa-check"></i><b>5.2.2</b> Two Ways to Plot II</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="regression-basics.html"><a href="regression-basics.html"><i class="fa fa-check"></i><b>6</b> Regression Basics</a><ul>
<li class="chapter" data-level="6.1" data-path="regression-basics.html"><a href="regression-basics.html#ordinary-least-squares-ols-regression"><i class="fa fa-check"></i><b>6.1</b> Ordinary Least Squares (OLS) Regression</a><ul>
<li class="chapter" data-level="6.1.1" data-path="regression-basics.html"><a href="regression-basics.html#diagnostics"><i class="fa fa-check"></i><b>6.1.1</b> Diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="regression-basics.html"><a href="regression-basics.html#prediction"><i class="fa fa-check"></i><b>6.2</b> Prediction</a></li>
<li class="chapter" data-level="6.3" data-path="regression-basics.html"><a href="regression-basics.html#residual-plots"><i class="fa fa-check"></i><b>6.3</b> Residual Plots</a></li>
<li class="chapter" data-level="6.4" data-path="regression-basics.html"><a href="regression-basics.html#regression-output-table"><i class="fa fa-check"></i><b>6.4</b> Regression Output Table</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="advanced-regression.html"><a href="advanced-regression.html"><i class="fa fa-check"></i><b>7</b> Advanced Regression</a><ul>
<li class="chapter" data-level="7.1" data-path="advanced-regression.html"><a href="advanced-regression.html#multivariate-regression"><i class="fa fa-check"></i><b>7.1</b> Multivariate Regression</a></li>
<li class="chapter" data-level="7.2" data-path="advanced-regression.html"><a href="advanced-regression.html#dummy-variables"><i class="fa fa-check"></i><b>7.2</b> Dummy Variables</a></li>
<li class="chapter" data-level="7.3" data-path="advanced-regression.html"><a href="advanced-regression.html#polynomial-regression"><i class="fa fa-check"></i><b>7.3</b> Polynomial Regression</a><ul>
<li class="chapter" data-level="7.3.1" data-path="advanced-regression.html"><a href="advanced-regression.html#higher-polynomials"><i class="fa fa-check"></i><b>7.3.1</b> Higher Polynomials</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="advanced-regression.html"><a href="advanced-regression.html#logarithmic-models"><i class="fa fa-check"></i><b>7.4</b> Logarithmic Models</a></li>
<li class="chapter" data-level="7.5" data-path="advanced-regression.html"><a href="advanced-regression.html#standardizing-variables"><i class="fa fa-check"></i><b>7.5</b> Standardizing Variables</a></li>
<li class="chapter" data-level="7.6" data-path="advanced-regression.html"><a href="advanced-regression.html#panel-data"><i class="fa fa-check"></i><b>7.6</b> Panel Data</a><ul>
<li class="chapter" data-level="7.6.1" data-path="advanced-regression.html"><a href="advanced-regression.html#two-way-fixed-effects"><i class="fa fa-check"></i><b>7.6.1</b> Two Way Fixed Effects</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://ryansafner.com" target="blank">Ryan Safner</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R For Econometrics: A Modest Handbook</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regression-basics" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Regression Basics</h1>
<div id="ordinary-least-squares-ols-regression" class="section level2">
<h2><span class="header-section-number">6.1</span> Ordinary Least Squares (OLS) Regression</h2>
<p>In <code>R</code>, the Ordinary Least Squares (OLS) regression model is simply called the <strong>“linear model”</strong>, abbreviated <code>lm</code>. Regressions are run on several variables from a <code>data.frame</code> and stored as a <code>lm</code> object that we can inspect and modify.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">set.seed=<span class="dv">1</span> <span class="co">#makes &#39;random&#39; draws reproducible </span>
x&lt;-<span class="kw">runif</span>(<span class="dv">500</span>,<span class="dt">min=</span><span class="dv">0</span>,<span class="dt">max=</span><span class="dv">10</span>) <span class="co">#500 draws from uniform distr </span>
y&lt;-<span class="dv">2</span><span class="op">*</span>x<span class="op">+</span><span class="kw">rnorm</span>(<span class="dv">500</span>,<span class="dv">2</span>,<span class="dv">4</span>)
my_df&lt;-<span class="kw">data.frame</span>(x,y)

<span class="kw">ggplot</span>(my_df, <span class="kw">aes</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y))<span class="op">+</span>
<span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">alpha=</span><span class="fl">0.5</span>)<span class="op">+</span>
<span class="st">        </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">color=</span><span class="st">&quot;green&quot;</span>)<span class="op">+</span>
<span class="st">        </span><span class="kw">xlim</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">10</span>))<span class="op">+</span><span class="kw">theme_light</span>()</code></pre></div>
<p><img src="R4EH_book_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<p>The syntax for running a regression in <code>R</code> is simple. We store the regression as an <code>lm()</code> object (e.g. called “<code>my_reg</code>”) and regress our dependent (<code>mydf$y</code>) variable on (<code>~</code>) the independent (<code>my_df$x</code>) variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_reg&lt;-<span class="kw">lm</span>(df<span class="op">$</span>y<span class="op">~</span>df<span class="op">$</span>x)</code></pre></div>
<p>Alternatively, we can simply use the variable <code>names</code> from <code>my_df</code> and then tell <code>R</code> that the variables are coming from <code>my_df</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_reg&lt;-<span class="kw">lm</span>(y<span class="op">~</span>x, <span class="dt">data =</span> my_df)</code></pre></div>
<p><span class="math display">\[y=\beta_0+\beta_1 x\]</span></p>
<p>When we inspect our <code>lm</code> object, <code>R</code> simply prints the coefficients (“<code>Intercept</code>” for <span class="math inline">\(\hat{\beta_0}\)</span>) and (“<code>x</code>” for <span class="math inline">\(\hat{\beta_1}\)</span> on <span class="math inline">\(x\)</span>):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_reg</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = my_df)
## 
## Coefficients:
## (Intercept)            x  
##       2.009        2.055</code></pre>
<p>We can get a more detailed summary by running <code>summary()</code> on our <code>lm</code> object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(my_reg)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x, data = my_df)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -12.8557  -2.5953   0.0959   2.7723  12.2560 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  2.00888    0.37323   5.382 1.13e-07 ***
## x            2.05475    0.06362  32.299  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.033 on 498 degrees of freedom
## Multiple R-squared:  0.6769, Adjusted R-squared:  0.6762 
## F-statistic:  1043 on 1 and 498 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>The <code>summary()</code> prints:</p>
<ul>
<li>The formula for the regression</li>
<li>A 5 number summary of the distribution of the residuals</li>
<li>Table of coefficients
<ul>
<li>Column 1: Estimate for each <span class="math inline">\(\beta\)</span></li>
<li>Column 2: Standard error of each <span class="math inline">\(\beta\)</span></li>
<li>Column 3: <span class="math inline">\(t\)</span>-statistic for each <span class="math inline">\(\beta\)</span> with <span class="math inline">\(H_0: \, \beta=0\)</span></li>
<li>Column 4: <span class="math inline">\(p\)</span>-value for the <span class="math inline">\(t\)</span>-test</li>
</ul></li>
<li>Regression Diagnostics
<ul>
<li>Standard error of the regression (SER), <code>R</code> calls it <code>Residual standard error (RSE)</code></li>
<li><code>R-squared</code> and <code>Adjusted R-squared</code></li>
<li>“All <span class="math inline">\(F\)</span>-test” where <span class="math inline">\(H_0: \text{ all } \beta\text{&#39;s}=0\)</span></li>
</ul></li>
</ul>
<p>Inside the <code>lm</code> object <code>my_reg</code> is stored a lot of things that may not show up in the <code>summary</code>. To get a full inspection, check the structure with <code>str()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(my_reg)</code></pre></div>
<pre><code>## List of 12
##  $ coefficients : Named num [1:2] 2.01 2.05
##   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;(Intercept)&quot; &quot;x&quot;
##  $ residuals    : Named num [1:500] 0.697 -3.698 3.962 -0.943 1.215 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:500] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ effects      : Named num [1:500] -280.92 -130.25 4.03 -1.04 1.08 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:500] &quot;(Intercept)&quot; &quot;x&quot; &quot;&quot; &quot;&quot; ...
##  $ rank         : int 2
##  $ fitted.values: Named num [1:500] 17.23 20.21 16.37 10.26 8.96 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:500] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##  $ assign       : int [1:2] 0 1
##  $ qr           :List of 5
##   ..$ qr   : num [1:500, 1:2] -22.3607 0.0447 0.0447 0.0447 0.0447 ...
##   .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. ..$ : chr [1:500] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. .. ..$ : chr [1:2] &quot;(Intercept)&quot; &quot;x&quot;
##   .. ..- attr(*, &quot;assign&quot;)= int [1:2] 0 1
##   ..$ qraux: num [1:2] 1.04 1.06
##   ..$ pivot: int [1:2] 1 2
##   ..$ tol  : num 1e-07
##   ..$ rank : int 2
##   ..- attr(*, &quot;class&quot;)= chr &quot;qr&quot;
##  $ df.residual  : int 498
##  $ xlevels      : Named list()
##  $ call         : language lm(formula = y ~ x, data = my_df)
##  $ terms        :Classes &#39;terms&#39;, &#39;formula&#39;  language y ~ x
##   .. ..- attr(*, &quot;variables&quot;)= language list(y, x)
##   .. ..- attr(*, &quot;factors&quot;)= int [1:2, 1] 0 1
##   .. .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. .. ..$ : chr [1:2] &quot;y&quot; &quot;x&quot;
##   .. .. .. ..$ : chr &quot;x&quot;
##   .. ..- attr(*, &quot;term.labels&quot;)= chr &quot;x&quot;
##   .. ..- attr(*, &quot;order&quot;)= int 1
##   .. ..- attr(*, &quot;intercept&quot;)= int 1
##   .. ..- attr(*, &quot;response&quot;)= int 1
##   .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt; 
##   .. ..- attr(*, &quot;predvars&quot;)= language list(y, x)
##   .. ..- attr(*, &quot;dataClasses&quot;)= Named chr [1:2] &quot;numeric&quot; &quot;numeric&quot;
##   .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;y&quot; &quot;x&quot;
##  $ model        :&#39;data.frame&#39;:   500 obs. of  2 variables:
##   ..$ y: num [1:500] 17.93 16.51 20.33 9.32 10.18 ...
##   ..$ x: num [1:500] 7.41 8.86 6.99 4.02 3.38 ...
##   ..- attr(*, &quot;terms&quot;)=Classes &#39;terms&#39;, &#39;formula&#39;  language y ~ x
##   .. .. ..- attr(*, &quot;variables&quot;)= language list(y, x)
##   .. .. ..- attr(*, &quot;factors&quot;)= int [1:2, 1] 0 1
##   .. .. .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. .. .. ..$ : chr [1:2] &quot;y&quot; &quot;x&quot;
##   .. .. .. .. ..$ : chr &quot;x&quot;
##   .. .. ..- attr(*, &quot;term.labels&quot;)= chr &quot;x&quot;
##   .. .. ..- attr(*, &quot;order&quot;)= int 1
##   .. .. ..- attr(*, &quot;intercept&quot;)= int 1
##   .. .. ..- attr(*, &quot;response&quot;)= int 1
##   .. .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt; 
##   .. .. ..- attr(*, &quot;predvars&quot;)= language list(y, x)
##   .. .. ..- attr(*, &quot;dataClasses&quot;)= Named chr [1:2] &quot;numeric&quot; &quot;numeric&quot;
##   .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;y&quot; &quot;x&quot;
##  - attr(*, &quot;class&quot;)= chr &quot;lm&quot;</code></pre>
<p>Note that <code>lm</code> objects are actually <code>list</code>s, (<code>data.frame</code>s are also <code>list</code>s), so we can extract elements of the list and subset using <code>$</code> or <code>[[]]</code>. Some of the important elements of the list:</p>
<ul>
<li><code>my_reg$coefficients</code> is a list of coefficients</li>
<li><code>my_reg$residuals</code> is a list comprised of the residual for each <code>x</code> value</li>
<li><code>my_reg$fitted.values</code> is a list comprised of the predicted/fitted value (<span class="math inline">\(\hat{y}\)</span>) for each <code>x</code> value</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_reg<span class="op">$</span>coefficients <span class="co"># look at coefficients</span></code></pre></div>
<pre><code>## (Intercept)           x 
##    2.008878    2.054752</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_reg<span class="op">$</span>residuals[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>] <span class="co"># look at first 5 residuals</span></code></pre></div>
<pre><code>##          1          2          3          4          5 
##  0.6973776 -3.6984978  3.9621023 -0.9432491  1.2149809</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_reg<span class="op">$</span>fitted.values[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>] <span class="co"># look at first 5 fitted.values</span></code></pre></div>
<pre><code>##         1         2         3         4         5 
## 17.231787 20.213383 16.371113 10.261878  8.961116</code></pre>
<p>These stored values will come in handy. We can run functions on them, for example, to discover things about the residuals:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(my_reg<span class="op">$</span>residuals) <span class="co"># the same as the first thing printed in the regression output above!</span></code></pre></div>
<pre><code>##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
## -12.85568  -2.59527   0.09591   0.00000   2.77227  12.25596</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(my_reg<span class="op">$</span>residuals) <span class="co"># the standard deviation of the residuals </span></code></pre></div>
<pre><code>## [1] 4.028697</code></pre>
<p>Since these are stored in <code>lm</code> as objects, we can also assign them to new columns in our original <code>data.frame</code>, <code>my_df</code>. This can be helpful for plotting with <code>x</code>, <code>y</code>, the residuals <span class="math inline">\(\epsilon\)</span>, and the predicted values <span class="math inline">\(\hat{y}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># save predicted values from model as &quot;yhat&quot;</span>
my_df<span class="op">$</span>yhat&lt;-my_reg<span class="op">$</span>fitted.values

<span class="co"># save residuals from model as &quot;res&quot;</span>
my_df<span class="op">$</span>res&lt;-my_reg<span class="op">$</span>residuals

<span class="co"># look at new dataframe</span>
<span class="kw">kable</span>(<span class="kw">head</span>(my_df))</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">x</th>
<th align="right">y</th>
<th align="right">yhat</th>
<th align="right">res</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">7.408637</td>
<td align="right">17.929164</td>
<td align="right">17.231787</td>
<td align="right">0.6973776</td>
</tr>
<tr class="even">
<td align="right">8.859711</td>
<td align="right">16.514885</td>
<td align="right">20.213383</td>
<td align="right">-3.6984978</td>
</tr>
<tr class="odd">
<td align="right">6.989767</td>
<td align="right">20.333215</td>
<td align="right">16.371113</td>
<td align="right">3.9621023</td>
</tr>
<tr class="even">
<td align="right">4.016544</td>
<td align="right">9.318629</td>
<td align="right">10.261878</td>
<td align="right">-0.9432491</td>
</tr>
<tr class="odd">
<td align="right">3.383493</td>
<td align="right">10.176097</td>
<td align="right">8.961116</td>
<td align="right">1.2149809</td>
</tr>
<tr class="even">
<td align="right">2.220068</td>
<td align="right">3.193837</td>
<td align="right">6.570566</td>
<td align="right">-3.3767291</td>
</tr>
</tbody>
</table>
<p>There are also specific functions for assigning the predicted values and the residuals to a <code>data.frame</code>, using the <code>lm</code> object as the argument. They will produce the same result as above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># save predicted values from model as &quot;yhat&quot;</span>
my_df<span class="op">$</span>yhat&lt;-<span class="kw">predict</span>(my_reg)

<span class="co"># save residuals from model as &quot;res&quot;</span>
my_df<span class="op">$</span>res&lt;-<span class="kw">residuals</span>(my_reg)

<span class="co"># we get the same result</span>
<span class="kw">head</span>(my_df)</code></pre></div>
<pre><code>##          x         y      yhat        res
## 1 7.408637 17.929164 17.231787  0.6973776
## 2 8.859710 16.514885 20.213383 -3.6984978
## 3 6.989767 20.333215 16.371113  3.9621023
## 4 4.016544  9.318629 10.261878 -0.9432491
## 5 3.383493 10.176097  8.961116  1.2149809
## 6 2.220068  3.193837  6.570566 -3.3767291</code></pre>
<div id="diagnostics" class="section level3">
<h3><span class="header-section-number">6.1.1</span> Diagnostics</h3>
<p>Some of the regression diagnostics are stored (idiosyncratically) in the <code>summary()</code> object, and can be extracted by name:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(my_reg)<span class="op">$</span>sigma <span class="co"># extract residual squared error (SER)</span></code></pre></div>
<pre><code>## [1] 4.03274</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(my_reg)<span class="op">$</span>r.squared <span class="co"># extract R^2</span></code></pre></div>
<pre><code>## [1] 0.6768818</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(my_reg)<span class="op">$</span>adj.r.squared <span class="co"># extract adjusted R^2</span></code></pre></div>
<pre><code>## [1] 0.6762329</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(my_reg)<span class="op">$</span>f <span class="co"># extract the F-statistic </span></code></pre></div>
<pre><code>##    value    numdf    dendf 
## 1043.231    1.000  498.000</code></pre>
<p>These might be useful if we wished to perform manual calculations using these statistics. As an example, if we wanted to calculate the correlation coefficient between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, and we know that <span class="math inline">\(R^2\)</span> is the correlation coefficient squared:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">R2&lt;-<span class="kw">summary</span>(my_reg)<span class="op">$</span>r.squared
<span class="kw">sqrt</span>(R2) </code></pre></div>
<pre><code>## [1] 0.8227282</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># compare to actual correlation coefficient</span>
<span class="kw">cor</span>(my_df<span class="op">$</span>x, my_df<span class="op">$</span>y)</code></pre></div>
<pre><code>## [1] 0.8227282</code></pre>
</div>
</div>
<div id="prediction" class="section level2">
<h2><span class="header-section-number">6.2</span> Prediction</h2>
<p>We can use the model to make pedictions using the estimated regression model.</p>
<p><span class="math display">\[\hat{Y}=2.090+1.974X\]</span></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x&lt;-<span class="dv">3</span>
prediction&lt;-my_reg<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>my_reg<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>x
prediction</code></pre></div>
<pre><code>## (Intercept) 
##    8.173133</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># multiple predictions</span>
x&lt;-<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">10</span>)
prediction&lt;-my_reg<span class="op">$</span>coef[<span class="dv">1</span>]<span class="op">+</span>my_reg<span class="op">$</span>coef[<span class="dv">2</span>]<span class="op">*</span>x
prediction</code></pre></div>
<pre><code>## [1]  4.063630  8.173133 16.392140 22.556395</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># alternatively, we can use the predict() function and insert </span>
<span class="co"># a dataframe of our desired x values to predict y-hat</span>
prediction2&lt;-<span class="kw">predict</span>(my_reg, <span class="kw">data.frame</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">7</span>,<span class="dv">10</span>)))
prediction2</code></pre></div>
<pre><code>##         1         2         3         4 
##  4.063630  8.173133 16.392140 22.556395</code></pre>
</div>
<div id="residual-plots" class="section level2">
<h2><span class="header-section-number">6.3</span> Residual Plots</h2>
<p>For more, see <a href="plotting.html#plotting">Plotting</a>{#04-plotting}.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> my_df, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> res))<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">color=</span><span class="st">&quot;red&quot;</span>)<span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span><span class="dv">0</span>, <span class="dt">color=</span><span class="st">&quot;blue&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="co"># add horizontal line at y=0</span>
<span class="st">  </span><span class="kw">theme_light</span>()</code></pre></div>
<p><img src="R4EH_book_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
</div>
<div id="regression-output-table" class="section level2">
<h2><span class="header-section-number">6.4</span> Regression Output Table</h2>
<p>The <code>broom</code> package converts <code>lm</code> objects into a tidy <code>data.frame</code> that can easily be printed in a nice table using <code>knitr</code>’s <code>kable()</code> function for <code>html</code> output.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages(&quot;broom&quot;) # install first if you don&#39;t have </span>
<span class="kw">library</span>(broom)
reg2&lt;-<span class="kw">tidy</span>(my_reg)
<span class="kw">kable</span>(reg2)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">2.008878</td>
<td align="right">0.3732339</td>
<td align="right">5.382356</td>
<td align="right">1e-07</td>
</tr>
<tr class="even">
<td align="left">x</td>
<td align="right">2.054752</td>
<td align="right">0.0636164</td>
<td align="right">32.299094</td>
<td align="right">0e+00</td>
</tr>
</tbody>
</table>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stargazer</span>(my_reg, <span class="dt">type=</span><span class="st">&quot;html&quot;</span>) </code></pre></div>
<table style="text-align:center">
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
<em>Dependent variable:</em>
</td>
</tr>
<tr>
<td>
</td>
<td colspan="1" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
y
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
x
</td>
<td>
2.055<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.064)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Constant
</td>
<td>
2.009<sup>***</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(0.373)
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Observations
</td>
<td>
500
</td>
</tr>
<tr>
<td style="text-align:left">
R<sup>2</sup>
</td>
<td>
0.677
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.676
</td>
</tr>
<tr>
<td style="text-align:left">
Residual Std. Error
</td>
<td>
4.033 (df = 498)
</td>
</tr>
<tr>
<td style="text-align:left">
F Statistic
</td>
<td>
1,043.231<sup>***</sup> (df = 1; 498)
</td>
</tr>
<tr>
<td colspan="2" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="plotting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="advanced-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["R4EH_book.pdf", "R4EH_book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
